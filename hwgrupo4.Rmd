---
date: "19/07/2020"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse);library(magrittr);library(readxl);library(knitr)
```

# Importando os dados
### Trazendo o .csv para dentro de um dataframe

```{r, results='hide'}
df <- read.csv("./Dados/caso_full.csv")


```

### Organizando os dados

Selecionando apenas as cidades, depois selecionando apenas as colunas de interesse e mudando o tipo da coluna de codigos do IBGE para alterarmos os nomes das cidades posteriormente. Por fim adicionamos uma coluna com os meses, separados das datas, pois é uma informação que usaremos para responder nossas perguntas.
```{r}
df <- df %>% filter(place_type == "city") %>% 
select(c("date",
         "city",
         "new_confirmed",
         "new_deaths",
         "state",
         "estimated_population_2019",
         "epidemiological_week",
         "city_ibge_code")) %>% 
  mutate(city_ibge_code = as.character(city_ibge_code)) %>% 
  mutate(Mes = substring(date,6,7))

```


Trazendo tabela com os códigos do IBGE e nomes certos das cidades
```{r}
codes <- read_excel("./Dados/Codigo_IBGE.xls")
```
Trazendo o nome correto para o Dataframe
```{r}
dfarrumado <- left_join(df,codes,by = c("city_ibge_code"="Código"))
```
Excluindo a coluna com os nomes mal formatados
```{r}
dfarrumado$city <- NULL
```
Arrumando a ordem e o nome das colunas
```{r}
df <- dfarrumado[,c(1,8,7,9,4,5,2,3)]
colnames(df) <- c("data","mes","codigo","municipio","estado","popest2019","novoscasos","novasmortes")

```

### Tabela gerada
Apenas as 6 primeiras linhas
```{r, echo = FALSE}
kable(head(df))
```


### Perguntas que pretendemos responder com a análise dos dados

1. Quais os municípios com o maior número de casos confirmados de Coronavírus?
2. Quais os municípios com o maior número de mortos por Coronavírus?
3. Os municípios com os maiores números de casos confirmados são os mesmos com os maiores números de mortos?
4. Fazer as mesmas análises para Estados e Regiões do Brasil.
5. Quais os 5 estados e 5 municípios que mais aumentaram o número de casos no mês de junho com relação ao maio?
6. Quais os 5 estados com o menor crescimento de casos no mês de junho com relação ao maio?
7. Quais os 5 estados e 5 municípios que mais aumentaram o número de óbitos no mês de junho com relação a maio?
8. Como foi a evolução dos casos nos estados e nos municípios identificados nas questões acima?


